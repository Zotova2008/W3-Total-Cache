# 2. Page Cache (Кэширование страниц)
## 2.1. [Basic settings](./2.1.page-cache-basic.md)
## 2.2. Advanced General

Вкладка **General** в этом разделе содержит основные параметры, которые определяют, какие страницы и типы контента будут кэшироваться, а также как обрабатывать различные запросы.

Настройки в блоке **General** раздела **Page Cache** определяют, какие страницы и типы контента будут кэшироваться, а также как обрабатывать запросы от авторизованных пользователей и специальные типы страниц. Для большинства сайтов рекомендуется включить кэширование постов, лент, HTTPS-запросов и XML, но быть осторожным с кэшированием 404-страниц и страниц для авторизованных пользователей. Всегда тестируйте изменения в **Preview Mode** (Performance → General Settings) и очищайте кэш после применения настроек (Performance → Dashboard → Empty All Caches).

---
## 1. General
### 1.1. Cache Posts Page

- **Описание**: Включает кэширование страницы записей (posts page), которая часто является самой посещаемой на блогах. Обычно это главная страница или страница архива записей (например, `example.com/blog/`).
- **Назначение**: Ускоряет загрузку страницы с постами, которая генерирует значительный трафик, снижая нагрузку на сервер.
- **Пример**: Если ваш блог получает 1000 просмотров в день на странице `example.com/`, включение этой опции сохранит её как статический HTML, сократив время загрузки с 2 секунд до 0.5 секунды.
- **Рекомендация**: Включите, особенно для блогов или сайтов, где страница записей активно посещается.
- **Осторожно**: Если страница записей содержит динамический контент (например, персонализированные рекомендации), проверьте, не нарушает ли кэширование функциональность.

---

### 1.2. Don’t Cache Front Page

- **Описание**: Отключает кэширование главной страницы сайта, даже если в настройках WordPress (Settings → Reading) выбрана статическая главная страница.
- **Назначение**: Позволяет показывать актуальную версию главной страницы, если она часто обновляется или содержит динамический контент.
- **Пример**: Если ваша главная страница `example.com` отображает последние новости или персонализированные баннеры, отключение кэширования обеспечит её свежесть.
- **Рекомендация**: Отключите, если главная страница динамическая (например, интернет-магазин с изменяющимися товарами). Включите кэширование (оставьте галочку снятой), если главная страница статична, например, лендинг.
- **Осторожно**: Отключение кэширования увеличит нагрузку на сервер, особенно если главная страница популярна.

---

### 1.3. Cache Feeds: Site, Categories, Tags, Comments

- **Описание**: Включает кэширование RSS/Atom-лент для сайта, категорий, тегов и комментариев.
- **Назначение**: Ускоряет загрузку лент для RSS-читалок и снижает нагрузку на сервер, даже если вы используете сторонний сервис для лент (например, FeedBurner).
- **Пример**: Включение этой опции кэширует `example.com/feed/`, что уменьшает запросы к базе данных при обращении RSS-читалок.
- **Рекомендация**: Включите для блогов или новостных сайтов, где RSS-ленты активно используются. Это стандартная практика для оптимизации.
- **Осторожно**: Если ленты содержат динамический контент (например, персонализированные данные), проверьте их работу после включения кэширования.

---

### 1.4. Handle XML MIME Type

- **Описание**: Указывает серверу возвращать правильный заголовок `Content-Type` для XML-файлов, таких как RSS-ленты и XML-карты сайта.
- **Назначение**: Обеспечивает корректную обработку XML-файлов браузерами и сервисами, улучшая совместимость.
- **Пример**: Включение этой опции гарантирует, что `example.com/sitemap.xml` будет отправляться с заголовком `Content-Type: application/xml`, что важно для поисковых систем.
- **Рекомендация**: Включите, если ваш сайт использует RSS-ленты или XML-карты сайта. Это безопасная и полезная настройка.
- **Осторожно**: Убедитесь, что ваш сервер не переопределяет заголовки, иначе могут возникнуть конфликты.

---

### 1.5. Cache SSL (HTTPS) Requests

- **Описание**: Включает кэширование страниц, доступных по протоколу HTTPS, с уникальным кэшем для HTTPS-запросов.
- **Назначение**: Ускоряет загрузку страниц для пользователей, использующих HTTPS, что является стандартом для большинства сайтов.
- **Пример**: Если ваш сайт работает по HTTPS (`https://example.com`), включение этой опции создаст кэш для HTTPS-версий страниц, сократив время ответа.
- **Рекомендация**: Включите, так как большинство сайтов используют HTTPS. Это улучшает производительность без дополнительных рисков.
- **Осторожно**: Убедитесь, что ваш сайт полностью настроен на HTTPS, чтобы избежать смешанного контента (mixed content).

---

### 1.6. Cache URIs with Query String Variables

- **Описание**: Включает кэширование страниц с параметрами запроса (query strings) в URL, которые обычно считаются динамическими.
- **Назначение**: Позволяет кэшировать страницы, такие как результаты поиска (`example.com/?s=keyword`) или страницы с UTM-метками, для улучшения скорости.
- **Пример**: Если включить эту опцию, страница `example.com/?s=wordpress` будет кэшироваться, что ускорит повторные поисковые запросы.
- **Рекомендация**: Включите, если ваш сайт активно использует параметры запроса для статичного контента (поиск, фильтры, аналитика). Укажите конкретные параметры в настройке **Cache URI Query Strings** (вкладка Advanced).
- **Осторожно**: Неправильное кэширование динамических параметров (например, `session_id`) может привести к ошибкам. Тестируйте в Preview Mode.

---

### 1.7. Cache 404 (Not Found) Pages

- **Описание**: Включает кэширование страниц с ошибкой 404, чтобы снизить нагрузку на сервер при частых запросах несуществующих страниц.
- **Назначение**: Уменьшает количество запросов к серверу, когда боты или пользователи обращаются к несуществующим URL.
- **Пример**: Если боты часто запрашивают `example.com/old-page/`, кэширование 404-ответа снизит нагрузку на сервер.
- **Рекомендация**: Отключите, так как кэширование 404-страниц редко требуется и может вызвать проблемы. Например, при использовании метода **Disk: Enhanced** 404-страницы могут возвращаться с кодом 200, что сбивает поисковые системы.
- **Осторожно**: Используйте только если у вас высокий трафик 404-запросов и вы понимаете риски. Тестируйте с осторожностью.

---

### 1.8. Don’t Cache Pages for Logged-in Users

- **Описание**: Отключает кэширование страниц для авторизованных пользователей, чтобы они видели актуальную версию сайта.
- **Назначение**: Предотвращает показ устаревшего кэша для пользователей, которые вошли в систему, что важно для персонализированного контента.
- **Пример**: Если пользователь вошёл в личный кабинет на `example.com/my-account/`, он увидит некэшированную версию страницы с актуальными данными.
- **Рекомендация**: Включите для сайтов с персонализированным контентом (например, WooCommerce, форумы, личные кабинеты). Отключите, если ваш сайт в основном статичен и авторизованные пользователи составляют большую часть трафика.
- **Осторожно**: **Отключение этой опции не рекомендуется**. Включение увеличит нагрузку на сервер, если у вас много авторизованных пользователей.

---

### 1.9. Don’t Cache Pages for Following User Roles

- **Описание**: Исключает кэширование страниц для выбранных ролей пользователей (например, Administrator, Editor, Author, Contributor, Subscriber, SEO Manager, SEO Editor, Translator).
- **Назначение**: Позволяет определённым ролям пользователей (обычно администраторам и редакторам) видеть некэшированные версии страниц для актуального редактирования.
- **Пример**: Установите "Administrator" и "Editor", чтобы эти пользователи всегда видели свежие версии страниц, например, при редактировании постов.
- **Рекомендация**: Включите для ролей, которые активно редактируют контент (Administrator, Editor, Author). Не включайте для ролей с большим количеством пользователей (например, Subscriber), чтобы не отключать кэш для основной аудитории.
- **Осторожно**: Слишком много исключённых ролей увеличат нагрузку на сервер, особенно на shared-хостинге.

---


## Рекомендации для блока General

| Настройка | Рекомендация |
|-----------|--------------|
| Cache Posts Page | Включить для блогов |
| Don’t Cache Front Page | Отключить для статичных страниц, включить для динамичных |
| Cache Feeds | Включить для блогов и новостных сайтов |
| Handle XML MIME Type | Включить для RSS и sitemap |
| Cache SSL (HTTPS) Requests | Включить для HTTPS-сайтов |
| Cache URIs with Query String Variables | Включить для поиска и аналитики, настроить параметры |
| Cache 404 Pages | Отключить |
| Don’t Cache Pages for Logged-in Users | Включить для персонализированного контента |
| Don’t Cache Pages for Following User Roles | Включить для Administrator, Editor, Author |

---

## Примеры использования

- **Блог**:
  - Включите **Cache Posts Page**, **Cache Feeds**, **Handle XML MIME Type**, **Cache SSL Requests**.
  - Отключите **Don’t Cache Front Page**, если главная страница статична.
  - Включите **Cache URIs with Query String Variables** для поиска (`s`).
  - Включите **Don’t Cache Pages for Logged-in Users** и исключите роли Administrator, Editor.

- **WooCommerce**:
  - Включите **Cache SSL Requests**, **Handle XML MIME Type**.
  - Включите **Don’t Cache Pages for Logged-in Users** и **Don’t Cache Front Page**, если главная страница показывает динамические товары.
  - Отключите **Cache 404 Pages**.
  - Исключите роли Administrator и Editor.

- **Новостной сайт**:
  - Включите **Cache Posts Page**, **Cache Feeds**, **Handle XML MIME Type**, **Cache SSL Requests**.
  - Включите **Cache URIs with Query String Variables** для параметров фильтров.
  - Включите **Don’t Cache Pages for Logged-in Users** для журналистов.
  - Исключите роли Editor, Author.
